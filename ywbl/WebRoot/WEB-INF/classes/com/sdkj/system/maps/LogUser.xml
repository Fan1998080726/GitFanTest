<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace ="Login" > 


   <typeAlias alias ="userInfo" type ="com.sdkj.system.vo.UserInfo"/> 
   <typeAlias alias ="menus" type ="com.sdkj.system.vo.Menus"/> 


   <select id ="querylogin" resultClass="java.util.HashMap" parameterClass ="userInfo"  > 
    <!-- 	select id,login_id,login_password,user_name,a.role_id,
		phone,email,address,a.memo,b.dept_id
		 from system_user_info a,system_role_info b
		where a.role_id=b.role_id and login_id = #login_id# and login_password = #login_password# -->
			select id,login_id,login_password,user_name,a.role_id,
		phone,email,address,a.memo,a.createuser,b.dept_id,c.dept_name
		 from system_user_info a,system_role_info b,SYSTEM_DEPT_INFO c	
		where a.role_id=b.role_id and b.dept_id=c.dept_id and login_id = #login_id# and login_password = #login_password#
   </select > 
   
   <select id ="queryforAdminlog" resultClass="java.util.HashMap" parameterClass ="userInfo"  > 
    <!-- 	select id,login_id,login_password,user_name,a.role_id,
		phone,email,address,a.memo,b.dept_id
		 from system_user_info a,system_role_info b
		where a.role_id=b.role_id and login_id = #login_id# and login_password = #login_password# -->
			select id,login_id,login_password,user_name,a.role_id,
		phone,email,address,a.memo,a.createuser,b.dept_id,c.dept_name
		 from system_user_info a,system_role_info b,SYSTEM_DEPT_INFO c	
		where a.role_id=b.role_id and b.dept_id=c.dept_id and login_id = #login_id# 
   </select > 
   
   <select id ="queryUserMenuById" resultClass="menus" parameterClass ="java.util.HashMap"  > 
    	
    	SELECT menu_id,menu_pid,menu_name,menu_url,menu_image,is_child,menu_with_pro
 		from system_menu_info where menu_id in (
			SELECT menu_id from system_role_menu where role_id = #role_id#
		)  
		<isEmpty prepend="and" property="pro_id">
            menu_with_pro=0
        </isEmpty> 
		ORDER BY to_number(menu_id)
    	
   </select > 
   
   <select id ="queryforchild" resultClass="menus" parameterClass ="java.lang.String"  > 
				SELECT
				*
			FROM
				system_menu_info
			where menu_pid = #menu_id#
			ORDER BY
				menu_id
   </select > 

      <update id="addLog" parameterClass="java.lang.String">
		$value$
	  </update>

      <update id="addProcheckLog" parameterClass="java.lang.String">
		$value$
	  </update>
	

      <update id="gasaddlog" parameterClass="java.lang.String">
		$value$
	  </update>
	
	
      <update id="addExaminationlog" parameterClass="java.lang.String">
		$value$
	  </update>
</sqlMap > 
